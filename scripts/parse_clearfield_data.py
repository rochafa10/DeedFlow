#!/usr/bin/env python3
"""
Clearfield County Tax Sale Property Parser
Parses property data extracted from scanned PDF images
"""

import os
from supabase import create_client, Client
from datetime import datetime

# Configuration
SUPABASE_URL = os.getenv("SUPABASE_URL", "https://oiiwlzobizftprqspbzt.supabase.co")
SUPABASE_KEY = os.getenv("SUPABASE_SERVICE_ROLE_KEY", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9paXdsem9iaXpmdHBycXNwYnp0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUwNDc4MzUsImV4cCI6MjA3MDYyMzgzNX0.idwK7IxweMNK64lOGZlWUFV9pA9zljZmZY65rAiDFzg")

supabase: Client = create_client(SUPABASE_URL, SUPABASE_KEY)

# Property data extracted from PDF images (2025 Tax Sale List - Sale Year 2026)
# Format: (control_num, address, owner, map_number, upset_price, township)

CLEARFIELD_PROPERTIES = [
    # Page 2 - BURNSIDE BOROUGH
    ("002020094", "W RIVER RD", "PEARCE KENDRA A", "A13-310-0008", 640.90, "BURNSIDE BOROUGH"),
    ("002000117", "754 MAIN ST", "KANYIGO TERESIA MA IKISUMUJIMBU BLOO & LL", "A13-310-0030", 5815.19, "BURNSIDE BOROUGH"),

    # CLEARFIELD BOROUGH
    ("002440445", "30 SPRUCE GRVE LN", "BROWN DARA JANE", "K08-200-0006-TL-17", 606.80, "CLEARFIELD BOROUGH"),
    ("002440446", "112 MCNEAL ST", "MCDANIEL/CRAIG A & VALERIE C", "H & I PART OF 3 L15 111-112", 10224.18, "CLEARFIELD BOROUGH"),
    ("002405082", "401 W FRONT ST", "BROWN FREDERICK H", "L06-214-0002", 4444.82, "CLEARFIELD BOROUGH"),
    ("004402194", "402 E 11TH ST", "CLARK STEPHEN JR & EMILY J", "K08-249-0118", 8327.18, "CLEARFIELD BOROUGH"),
    ("002440447", "412 LOCUST ST", "DOON/RAMAH N JEAN", "K08-217-0028-A", 8316.14, "CLEARFIELD BOROUGH"),

    # COALPORT BOROUGH
    ("000002039", "HEVERLEY BLVD", "RAINELLI THOMAS", "H17-347-0067", 1134.25, "COALPORT BOROUGH"),
    ("002440448", "500 MILL ST", "LAUVER DENNIS R & VIOLA A", "H17-347-0041", 486.85, "COALPORT BOROUGH"),

    # CURWENSVILLE BOROUGH
    ("002060653", "433 LOCUST ST", "BLOOM JUSTIN KYLE", "H09-253-0017", 3900.79, "CURWENSVILLE BOROUGH"),
    ("002060654", "RIVERVIEW DR", "BLOOM JUSTIN KYLE", "2 Parcels", 887.32, "CURWENSVILLE BOROUGH"),

    # DUBOIS CITY
    ("007105335", "725 W WASHINGTON AVE", "DAMBROSIO ALBERT & SHIRLEY", "F08-000-2279A", 3069.00, "DUBOIS CITY"),
    ("007105360", "143 ROBINSON ST", "BARRETT JANICE A", "F08-000-0401", 505.58, "DUBOIS CITY"),
    ("002215063", "19 W LONG AVE", "STEWART JULIE A", "F08-000-1010/0102", 670.71, "DUBOIS CITY"),
    ("002215063", "134 W LONG AVE", "STEWART JULIE A", "F08-000-0081", 2251.09, "DUBOIS CITY"),

    # Page 3 - DUBOIS CITY continued
    ("002016147", "10 S STOCKDALE ST", "DOULT DANIEL B", "F04-000-0060", 2140.27, "DUBOIS CITY"),
    ("007078002", "Clearfield County", "DUNN BERTHA LYNNE", "F04-000-0031MH", 552.17, "DUBOIS CITY"),
    ("007210313", "701 WALNUT ST", "REAY WILLIAM HR", "D13-000-0281", 7140.22, "DUBOIS CITY"),

    # TROUTVILLE BOROUGH
    ("070440050", "Clearfield County", "EDMOND JARRETT L", "M14-204-0050B", 998.08, "TROUTVILLE BOROUGH"),

    # BECCARIA TOWNSHIP
    ("010010709", "Clearfield County", "LEHIDA JAMES J", "H16-000-525", 528.00, "BECCARIA TOWNSHIP"),
    ("100110117", "ELIZABETH ST", "LUKASION WACKO HEIRS", "K10-003D001", 777.03, "BECCARIA TOWNSHIP"),
    ("100110217", "292 12 BNK", "SCHOENDIENST JOHN 2 JR & PATRICIA R", "K10-003-0013", 4369.80, "BECCARIA TOWNSHIP"),
    ("010019968", "Clearfield County", "WALLACE AIJLETTE LOUISE", "H17-000-0005 MIN", 509.95, "BECCARIA TOWNSHIP"),
    ("010019968", "Clearfield County", "WALLACE AIJLETTE LOUISE", "H17-000-0023", 509.95, "BECCARIA TOWNSHIP"),
    ("010019969", "Clearfield County", "DANVIR EDWARD JR", "D13-000-0011", 4851.87, "BECCARIA TOWNSHIP"),

    # Page 4 - WESTOVER BOROUGH
    ("002015048", "Clearfield County", "ROAN MARLIN & SARAH", "D16-000-0006B", 2130.63, "WESTOVER BOROUGH"),

    # BECCARIA TOWNSHIP continued
    ("002015922", "Clearfield County", "LEHIDA JAMES J", "K08-200-0006-TL-17", 515.44, "BECCARIA TOWNSHIP"),
    ("100200002", "Clearfield County", "SPENCER SHAD B", "C15-000-0050 MIN", 484.85, "BECCARIA TOWNSHIP"),
    ("100200063", "Clearfield County", "SPENCER SHAD B", "C15-000-0055 MIN", 450.54, "BECCARIA TOWNSHIP"),
    ("100200094", "Clearfield County", "SPENCER SHAD B", "F14-000-0007", 449.94, "BECCARIA TOWNSHIP"),
    ("100200095", "Clearfield County", "SPENCER SHAD B", "B14-000-0012", 449.85, "BECCARIA TOWNSHIP"),
    ("100200096", "Clearfield County", "SPENCER SHAD B", "B14-000-0041", 449.66, "BECCARIA TOWNSHIP"),
    ("100200097", "Clearfield County", "SPENCER SHAD B", "E14-000-0010", 449.47, "BECCARIA TOWNSHIP"),
    ("100200098", "Clearfield County", "SPENCER SHAD B", "S16-000-0021-MN", 501.20, "BECCARIA TOWNSHIP"),
    ("100200099", "Clearfield County", "SPENCER SHAD B", "S16-000-0005-MIN", 509.94, "BECCARIA TOWNSHIP"),
    ("100200100", "Clearfield County", "SPENCER SHAD B", "S16-000-0020MIN", 504.55, "BECCARIA TOWNSHIP"),

    # CHEST TOWNSHIP
    ("100030171", "209 BLAKE RD", "WHITE EDNA J", "E17-000-0006", 1174.06, "CHEST TOWNSHIP"),
    ("100031238", "Clearfield County", "DAVIS HARRISON M & DIANA M", "E08-000-0041", 496.40, "CHEST TOWNSHIP"),
    ("100171293", "2000 FIVE POINTS RD", "MILLER PHYLLIS", "D14-000-0094", 2056.79, "CHEST TOWNSHIP"),

    # COOPER TOWNSHIP
    ("110022098", "289 TOOLEY ST", "SKAILE ORCHELLE M MALDONADO", "S08-028-0023", 616.94, "COOPER TOWNSHIP"),
    ("003440742", "Clearfield County", "SAMASNOST DORIS E & GREGO J", "S09-024-0054", 512.09, "COOPER TOWNSHIP"),

    # COVINGTON TOWNSHIP
    ("110046501", "Clearfield County", "DANVIR EDWARD JR", "R04-000-0006? MN", 403.82, "COVINGTON TOWNSHIP"),

    # Page 5 - BELL TOWNSHIP
    ("002040544", "Clearfield County", "ROBERTS CHERYL M", "AT1-411-0002M MN", 508.31, "BELL TOWNSHIP"),
    ("002040002", "Clearfield County", "BRUBAKER JOSEPHINE & ROBERT", "D11-000-0091P-MN", 503.59, "BELL TOWNSHIP"),
    ("002040004", "Clearfield County", "ROBERTS CHERYL M", "D11-000-0091M-MN", 508.31, "BELL TOWNSHIP"),
    ("002040006", "Clearfield County", "PAINTER WANDA", "D11-000-0050TL", 13904.16, "BELL TOWNSHIP"),

    # BIGLER TOWNSHIP
    ("003086893", "1733 SPRUCE ST", "NESTLERODE GEORGE E V & AMBER I", "K13-000-0027", 515.70, "BIGLER TOWNSHIP"),
    ("003086893", "Clearfield County", "LEHIDA JAMES J", "A14-000-0051M-MIN", 1087.33, "BIGLER TOWNSHIP"),

    # BLOOM TOWNSHIP
    ("104000885", "Clearfield County", "ROBINSON FRANK", "F09-000-00043 MN", 489.77, "BLOOM TOWNSHIP"),
    ("104044867", "Clearfield County", "VOUGHT BARBARA A", "000-0044-MN", 1267.73, "BLOOM TOWNSHIP"),
    ("004044801", "VAUGHT RD", "KLINGER WILLIAM H", "E08-000027", 547.82, "BLOOM TOWNSHIP"),

    # BOGGS TOWNSHIP
    ("005051917", "Clearfield County", "HODGKINS JOHN A", "I18-000-0002-MN", 455.88, "BOGGS TOWNSHIP"),
    ("005051919", "Clearfield County", "HUMI CLAYTON D", "D10-000 MN", 2017.56, "BOGGS TOWNSHIP"),
    ("105651065", "CHURCH HILL RD", "FOLMAR GERALDINE", "G11-578-0003BT", 1089.63, "BOGGS TOWNSHIP"),
    ("105651066", "OLD ERIE PIKE", "CASHER MICHAEL A & DEBORAH L", "D12-000-0060", 1094.02, "BOGGS TOWNSHIP"),
    ("105652077", "Clearfield County", "ROBINSON FRANK", "D11-000-0002", 385.35, "BOGGS TOWNSHIP"),
    ("005052134", "1807 RAILROAD ST", "BIEAL DOUG A", "E09-025-0016", 1679.80, "BOGGS TOWNSHIP"),
    ("105652577", "Clearfield County", "DIPASUILO LLC", "117-027-0001-MN", 3106.14, "BOGGS TOWNSHIP"),

    # Page 6 - BOGGS TOWNSHIP continued
    ("105652412", "Clearfield County", "DARIUCKA LLC", "M08-000-0006MIN", 843.34, "BOGGS TOWNSHIP"),
    ("105651208", "Clearfield County", "WILLIAM IOTIS W HEIRS", "M01-000-0006", 600.55, "BOGGS TOWNSHIP"),
    ("105695622", "Clearfield County", "DARIUCKA LLC", "M09-000-MN", 172.81, "BOGGS TOWNSHIP"),

    # BRADFORD TOWNSHIP
    ("106002802", "Clearfield County", "ROBINSON FRANK", "N06-000-0005D MN", 515.44, "BRADFORD TOWNSHIP"),
    ("006002802", "Clearfield County", "ROBINSON FRANK", "I09-000-0002 MN", 407.42, "BRADFORD TOWNSHIP"),
    ("107301006", "3007 SALA RD", "REED ROGER A MARY F", "D17-040-0034", 4687.13, "BRADFORD TOWNSHIP"),
    ("107304821", "4765 SHILOH DR", "ZIMMERMAN VIRGINIA M", "D09-311-0011", 9122.68, "BRADFORD TOWNSHIP"),
    ("106047305", "5044 ALLPORT CUTOFF", "BECHOLO JAMES", "D09-000-0020 TL-01", 1061.25, "BRADFORD TOWNSHIP"),
    ("106047308", "Clearfield County", "WYNN GRISELDA", "D03-000-0004", 1217.61, "BRADFORD TOWNSHIP"),

    # BRADY TOWNSHIP
    ("107070082", "3773 GOLDEN YCK RD", "DRAN ERIKA A", "D56-000-0033", 4804.96, "BRADY TOWNSHIP"),
    ("107070082", "Clearfield County", "GRONA ADAM T", "H12-000-0026-MN", 605.47, "BRADY TOWNSHIP"),
    ("107070073", "Clearfield County", "CONROE ENERGY HOLDINGS LLC IVA", "D14-000-0094", 131.06, "BRADY TOWNSHIP"),
    ("107070073", "Clearfield County", "CONROE ENERGY HOLDINGS LLC IVA", "C55-000-0024-MN", 509.44, "BRADY TOWNSHIP"),
    ("002085071", "Clearfield County", "SALADA MARGARET J & JAMES L", "C10-000-0054B", 7458.44, "BRADY TOWNSHIP"),

    # CLEARFIELD TOWNSHIP
    ("108058041", "836 STEFFLERTOWN RD", "KOLLER WAYNE A", "K19-213-0034", 1557.84, "CLEARFIELD TOWNSHIP"),
    ("108058042", "Clearfield County", "SPURGER BIRGIE ETAL", "C04-000-0054M", 606.80, "CLEARFIELD TOWNSHIP"),

    # Page 7 - BURNSIDE TOWNSHIP
    ("109030424", "1547 SCOLEY RD", "JUREWICZ ROXANNE M", "M14-000-00061", 1698.06, "BURNSIDE TOWNSHIP"),
    ("109030425", "2527 HARKINS HILL RD", "HURTADO ZARA", "M14-000-00025-TL-01", 672.10, "BURNSIDE TOWNSHIP"),
    ("100030002", "Clearfield County", "SPENCER SHAD B", "C15-000-0050 MIN", 484.85, "BURNSIDE TOWNSHIP"),
    ("100030063", "Clearfield County", "SPENCER SHAD B", "C15-000-0055 MIN", 450.54, "BURNSIDE TOWNSHIP"),
    ("100030094", "Clearfield County", "SPENCER SHAD B", "F14-000-0007", 449.94, "BURNSIDE TOWNSHIP"),
    ("100030095", "Clearfield County", "SPENCER SHAD B", "B14-000-0012", 449.85, "BURNSIDE TOWNSHIP"),
    ("100030096", "Clearfield County", "SPENCER SHAD B", "B14-000-0041", 449.66, "BURNSIDE TOWNSHIP"),
    ("100030097", "Clearfield County", "SPENCER SHAD B", "E14-000-0010", 449.47, "BURNSIDE TOWNSHIP"),
    ("100030098", "Clearfield County", "SPENCER SHAD B", "S16-000-0021-MN", 501.20, "BURNSIDE TOWNSHIP"),
    ("100030099", "Clearfield County", "SPENCER SHAD B", "S16-000-0005-MIN", 509.94, "BURNSIDE TOWNSHIP"),

    # Page 8 - COVINGTON TOWNSHIP
    ("110046501", "Clearfield County", "DANVIR EDWARD JR", "R00-000-0006? MN", 577.82, "COVINGTON TOWNSHIP"),

    # DECATUR TOWNSHIP
    ("112019740", "Clearfield County", "ROBINSON FRANK", "M12-000-000 MIN", 614.67, "DECATUR TOWNSHIP"),
    ("112019740", "SPRING ST", "GROSSNER KENNETH T ET AL", "H14-000-0001", 755.34, "DECATUR TOWNSHIP"),
    ("112030090", "176 PENDER RD", "LINDE LEE HODGINS", "J09-000-0002", 3749.40, "DECATUR TOWNSHIP"),
    ("112020300", "Clearfield County", "STOUT ROBERT B & CAROL A & A", "I10-000-0037", 642.73, "DECATUR TOWNSHIP"),
    ("012020325", "Clearfield County", "SANKEY RAYMOND HEIRS", "P10-000-0012-MN", 856.52, "DECATUR TOWNSHIP"),
    ("012025478", "Clearfield County", "SACKOLY EDWIN L & JOANN E", "I08-000-0029", 500.38, "DECATUR TOWNSHIP"),
    ("112021119", "FROG HOLLOW RD", "WIGFIELD WILBERT", "G12-000-0031", 428.35, "DECATUR TOWNSHIP"),
    ("012091987", "5400 MORGAN RUN RD", "BRATTON ROGER", "G11-000-0001", 510.03, "DECATUR TOWNSHIP"),
    ("012091987", "Clearfield County", "STOUT CAROL REAMS & ROBERT B", "I10-000-0037", 541.73, "DECATUR TOWNSHIP"),
    ("012091988", "Clearfield County", "STOUT CAROL REAMS & ROBERT B", "I08-000-0004", 572.18, "DECATUR TOWNSHIP"),
    ("112088752", "118 JACKS LN", "HARVEY AMBER D & JOSHUA S WADE", "I09-000-012 TL-01", 573.14, "DECATUR TOWNSHIP"),

    # FERGUSON TOWNSHIP
    ("113010463", "Clearfield County", "BEISH BARBARA J", "MIN-000-MN", 439.30, "FERGUSON TOWNSHIP"),
    ("013010574", "Clearfield County", "DAVIS HARRISON M & DIANA C", "E14-000-0001 MN", 695.07, "FERGUSON TOWNSHIP"),
    ("013010574", "Clearfield County", "ANDERSON LORI L", "E13-000-00012-MN", 439.30, "FERGUSON TOWNSHIP"),
    ("113033432", "Clearfield County", "BRUBAKER JOSEPHINE", "H12-000-0027 MN", 480.43, "FERGUSON TOWNSHIP"),
    ("013044064", "Clearfield County", "BRUBAKER JOSEPHINE & ROBERT", "E14-000-0003", 485.41, "FERGUSON TOWNSHIP"),
    ("013040453", "Clearfield County", "MELNYK DANIEL", "F15-000-0060 TL-5", 1052.08, "FERGUSON TOWNSHIP"),

    # Page 9 - FERGUSON TOWNSHIP continued
    ("113040517", "248 MONTGOMERY RD", "WESTOVER FRED", "H15-000-00006 DW-21", 1181.83, "FERGUSON TOWNSHIP"),
    ("113040521", "428 MONTGOMERY RD", "FETTERHOEF ROBERT J AND JESSE L", "F15-000-00056 TL-08", 2309.77, "FERGUSON TOWNSHIP"),
    ("113049831", "Clearfield County", "DANVIR EDWARD JR", "D16-000-0001F MN", 399.68, "FERGUSON TOWNSHIP"),

    # GIRARD TOWNSHIP
    ("014410706", "Clearfield County", "DREESEN LLC", "F06-000-00015", 563.46, "GIRARD TOWNSHIP"),
    ("114017327", "122 REDENBAUGH LN", "REDENBAUGH MARTIJN JR A", "P04-000-0132", 110.94, "GIRARD TOWNSHIP"),

    # GOSHEN TOWNSHIP
    ("114090001", "Clearfield County", "UNGLES CONNIE W", "M09-000-0002", 578.01, "GOSHEN TOWNSHIP"),
    ("114091000", "Clearfield County", "HENDERSON FRANK", "100-000 MIN", 2351.79, "GOSHEN TOWNSHIP"),
    ("105077463", "KNOEB RD", "WALLACE AIJLETTE LOUISE", "M08-000-0002", 405.78, "GOSHEN TOWNSHIP"),
    ("105077463", "KNOEB RD", "WALLACE AIJLETTE LOUISE", "000-000-0002MN", 543.40, "GOSHEN TOWNSHIP"),
    ("107070791", "Clearfield County", "RICHARDSON JENNIFER", "I05-000-0007 MN", 516.67, "GOSHEN TOWNSHIP"),
    ("107070808", "Clearfield County", "WALLACE AIJLETTE LOUISE", "M09-000-0043 MN", 445.28, "GOSHEN TOWNSHIP"),
    ("115077757", "Clearfield County", "WALLACE AIJLETTE LOUISE", "M08-067-0015 MN", 520.06, "GOSHEN TOWNSHIP"),
    ("115077758", "Clearfield County", "WALLACE AIJLETTE LOUISE", "M09-000-0061-MN", 530.00, "GOSHEN TOWNSHIP"),

    # GRAHAM TOWNSHIP
    ("115027134", "Clearfield County", "BEISH BARBARA J", "F09-000-0001 MN", 893.02, "GRAHAM TOWNSHIP"),

    # Page 10 - GREENWOOD TOWNSHIP
    ("117040612", "Clearfield County", "CHASE WEAVER DEIDRE", "E11-000-0002 MN", 457.10, "GREENWOOD TOWNSHIP"),
    ("117043062", "6007 NARQUITY GRAMPIAN HWY", "POTTS/COURTRIGHT", "E11-000-0018", 485.42, "GREENWOOD TOWNSHIP"),
    ("117044053", "536 LUMBER CITY HWY", "LOMAS MORGAN DENISE", "E11-000-024-4 TL-01", 3417.23, "GREENWOOD TOWNSHIP"),

    # GULICH TOWNSHIP
    ("017105008", "SMALL ST", "FRASIER ADAM & ASHLEY N", "L-14-000227", 509.95, "GULICH TOWNSHIP"),

    # HUSTON TOWNSHIP
    ("018022070", "57 MAYS RD", "MILLER LEE", "K03-000-0006E-TL-04", 11.12, "HUSTON TOWNSHIP"),
    ("018022090", "Clearfield County", "MURM JAMES C HEIRS", "E02-000-0006? M", 578.43, "HUSTON TOWNSHIP"),
    ("018100263", "2116 LAUREL RUN RD", "MURPHY JONATHAN D", "I04-000-0005-DW01", 693.29, "HUSTON TOWNSHIP"),
    ("018100264", "1586 LAUREL RUN RD", "EDGIGAN TIMOTHY", "003-000-0002", 707.79, "HUSTON TOWNSHIP"),
    ("018105420", "170 ANDERSON DR", "MOULIN CLARENCE D", "005-000-0050 MIN", 787.13, "HUSTON TOWNSHIP"),
    ("018105430", "109 BROWN RD", "LITTLE JERRY", "H03-000-0040-TL-13", 430.51, "HUSTON TOWNSHIP"),
    ("018105439", "38 PONDEROSA DR", "SMITH BRIAN", "I04-000-0005", 1079.71, "HUSTON TOWNSHIP"),
    ("018105439", "14 PONDEROSA DR", "SEGALIA MICHAEL", "002-000-012 TL-01", 843.13, "HUSTON TOWNSHIP"),
    ("119000091", "36 PONDEROSA DR", "SEGALIA MICHAEL", "002-000-012 TL-08", 1082.66, "HUSTON TOWNSHIP"),
    ("119000093", "40 PONDEROSA DR", "SEGALIA MICHAEL", "002-000-012 TL-01", 1141.66, "HUSTON TOWNSHIP"),
    ("119000067", "15 HEMLOCK DR", "APPELLANT JENNIFER M", "002-000-012 TL-01", 1142.13, "HUSTON TOWNSHIP"),
    ("119000072", "81 HEMLOCK DR", "SEGALIA MICHAEL", "002-000-012 TL-01", 1142.13, "HUSTON TOWNSHIP"),
    ("119000078", "20 PONDEROSA DR", "SEGALIA MICHAEL", "I03-000-0012", 879.64, "HUSTON TOWNSHIP"),
    ("119000078", "82 SEDGALO LN", "SEGALIA MICHAEL", "14 Parcels", 14196.92, "HUSTON TOWNSHIP"),

    # Page 11 - JORDAN TOWNSHIP
    ("002052002", "Clearfield County", "BECKETTE LAND CO INC", "H14-000-0034 MN", 809.23, "JORDAN TOWNSHIP"),
    ("012052002", "Clearfield County", "BECKETTE LAND CO INC", "H14-000-0032", 601.88, "JORDAN TOWNSHIP"),
    ("012064446", "Clearfield County", "CHAMPLIN D EDWARD", "C14-000-0012-MN", 601.88, "JORDAN TOWNSHIP"),

    # KARTHAUS TOWNSHIP
    ("120020908", "3455 MAIN ST", "CLARKE MWENI J", "T64-000? 0007", 645.99, "KARTHAUS TOWNSHIP"),
    ("120174878", "Clearfield County", "FLAHERTY REVOCABLE TRUST JOHN", "U02-000-0012", 1040.00, "KARTHAUS TOWNSHIP"),
    ("121074877", "Clearfield County", "DARIUCKA LLC", "U04-000-0042 MN", 481.01, "KARTHAUS TOWNSHIP"),
    ("121074877", "Clearfield County", "DARIUCKA LLC", "U03-000-0020 MN", 4903.72, "KARTHAUS TOWNSHIP"),

    # KNOX TOWNSHIP
    ("121020966", "Clearfield County", "JONES DOUGLAS D", "H13-000-0006A", 1479.68, "KNOX TOWNSHIP"),
    ("121045345", "PASADENA RD", "KNOB DIOUG", "J14-000-0012", 529.93, "KNOX TOWNSHIP"),
    ("121045368", "3006 DOUGLAS RD", "MEIKO MICHAEL S", "J10-000-0031", 542.15, "KNOX TOWNSHIP"),
    ("121050817", "Clearfield County", "CHASE WEAVER DEIDRE", "J11-000-0011 MIN", 541.34, "KNOX TOWNSHIP"),

    # LAWRENCE TOWNSHIP
    ("012304703", "210 SUMMIT ST", "JOHNSTON BOYD R & SHELA A", "K05-243-0038 TL-5", 621.11, "LAWRENCE TOWNSHIP"),
    ("012304579", "Clearfield County", "WARRING CAROLYN", "L17-137-000-0021-MN", 5036.05, "LAWRENCE TOWNSHIP"),
    ("123096560", "Clearfield County", "MOORE LARIE HEIRS", "K20-258-0001", 529.20, "LAWRENCE TOWNSHIP"),
    ("123080980", "Clearfield County", "MISER OR MULLER CHESTER", "K05-000-0160?", 472.70, "LAWRENCE TOWNSHIP"),
    ("123080087", "408 RACE ST", "CATOLUNA PAT W & SUSAN L", "K07-255-0042", 513.27, "LAWRENCE TOWNSHIP"),
    ("123080087", "227 NELSON RD", "ROSIE MELANG", "K02-000-0025", 4817.87, "LAWRENCE TOWNSHIP"),
    ("123080028", "Clearfield County", "CARRASCO GUILLERMO MARINO &", "L01-000-0016", 375.70, "LAWRENCE TOWNSHIP"),
    ("123087029", "BAY RD", "WALLACE AIJLETTE LOUISE", "K04-000-0008", 541.60, "LAWRENCE TOWNSHIP"),
    ("002117782", "ST BARTHELEMY RD", "PEREZ MARIOSO", "F04-000-0003TL", 605.60, "LAWRENCE TOWNSHIP"),

    # Page 12 - LAWRENCE TOWNSHIP continued
    ("123094054", "100 GOOD RD", "YATSKO CHRISTOPHER SCOT & S", "K07-000-0008 TL-01", 1541.07, "LAWRENCE TOWNSHIP"),
    ("123094054", "LEPORT CT", "DANIEL MAROJE A", "K09-256-0037", 467.06, "LAWRENCE TOWNSHIP"),
    ("126017892", "Clearfield County", "CLORICH HUGH", "C10-190-0430B", 684.41, "LAWRENCE TOWNSHIP"),
    ("126017804", "Clearfield County", "DELP STEVEN A AND MELISSA ANN", "C09-000-0012B", 723.18, "LAWRENCE TOWNSHIP"),
    ("126017804", "FORT 11 FINANCE RD", "YOUNG ELIZABETH T", "C08-000-0009", 750.37, "LAWRENCE TOWNSHIP"),
    ("126078944", "Clearfield County", "WEBER MATTHEW A", "C07-014-0010B", 520.06, "LAWRENCE TOWNSHIP"),
    ("126078946", "Clearfield County", "KALLGREN ARIEL T", "C07-041-0002", 461.90, "LAWRENCE TOWNSHIP"),
    ("126078956", "Clearfield County", "WINTERBOTTOM/HERBERT M", "C08-000-0015", 461.79, "LAWRENCE TOWNSHIP"),
    ("126073720", "Clearfield County", "KESORI ROBERT", "C09-000-0006/T MN", 679.42, "LAWRENCE TOWNSHIP"),
    ("126073720", "Clearfield County", "STUMP JAMES W & LINDA L", "C08-000-0040-02-21", 725.45, "LAWRENCE TOWNSHIP"),
    ("126051106", "Clearfield County", "WALPA ROBERT", "C08-000-0012", 375.93, "LAWRENCE TOWNSHIP"),
    ("126051106", "Clearfield County", "PHILLIPS PAUL KING & ELEANOR", "H14-000-0099", 586.56, "LAWRENCE TOWNSHIP"),
    ("126050993", "GRAND POURD RD", "ZELENKA SAMUEL J & JANET", "C09-000-0001?", 396.58, "LAWRENCE TOWNSHIP"),
    ("126050994", "Clearfield County", "ALLINGHAM GEORGE MCKAMY & B D", "J07-000-0034?", 606.80, "LAWRENCE TOWNSHIP"),
    ("126051081", "HARBOR VIEW RD", "PIETRO MARC & KAYANN", "C07-000-0001", 3006.21, "LAWRENCE TOWNSHIP"),
    ("126051217", "Clearfield County", "LAZOR THEODOSIS PREVOCABLE", "C06-000-0004", 636.92, "LAWRENCE TOWNSHIP"),
    ("126051044", "6 AUTUMN RD", "SANTOS LAUREEN", "C06-000-0000", 490.00, "LAWRENCE TOWNSHIP"),
    ("126052066", "172 CIRCLE RD", "HEMMPHILL HEATH", "000-000-0000 TL-32", 1725.38, "LAWRENCE TOWNSHIP"),
    ("126092052", "GALLOWAY RD", "PIOZZA GILBERT SHAWN & MARCIE", "C08-000-0004B", 215.41, "LAWRENCE TOWNSHIP"),
    ("126092054", "Clearfield County", "PORTER JILL", "C08-000-0017B", 672.31, "LAWRENCE TOWNSHIP"),
    ("126082708", "822 ST BARTHLEMEV RD", "LINDNAM CHRISTOPHER M & AMIE H", "C08-000-0025H", 8228.03, "LAWRENCE TOWNSHIP"),
    ("126082903", "WOOLENKIRK DR", "FOSTER MELANIE", "C13-000-0004 01", 685.08, "LAWRENCE TOWNSHIP"),
    ("126082903", "1000 BIRKEY DR", "MABOY HEIDI", "C13-000-0058", 636.97, "LAWRENCE TOWNSHIP"),
    ("126083715", "Clearfield County", "FORS/THE VELMA R TRUSTEE C/O", "C06-000-0012", 624.11, "LAWRENCE TOWNSHIP"),
    ("126084054", "Clearfield County", "BONFELD ROBERT M & SIELINDE", "C07-000-0035", 701.78, "LAWRENCE TOWNSHIP"),

    # Page 13 - SANDY TOWNSHIP
    ("129024005", "67 MAIN ST", "ARCDE JOHN", "D18-000-016-0902-21", 895.79, "SANDY TOWNSHIP"),
    ("129024045", "Clearfield County", "BROWNOCHER ELMER", "C02-014-0008-02-21", 1026.53, "SANDY TOWNSHIP"),
    ("128029377", "Clearfield County", "BENJAMIN GARY W & DARLENE M", "C02-018-0008B02", 4308.11, "SANDY TOWNSHIP"),
    ("128029378", "Clearfield County", "KOBUS JOHN T & JACQUELINE B", "C02-013-0002", 708.42, "SANDY TOWNSHIP"),
    ("128030179", "Clearfield County", "HEDI L TREALER", "L09-000-0002A", 1343.28, "SANDY TOWNSHIP"),
    ("128030457", "RUDDER LN", "BRINK CHARLIE D AND JOSHUA", "D17-000-0003?", 1743.28, "SANDY TOWNSHIP"),
    ("002180239", "CRAWFISH RD", "COPPERWITCH SHAWTEL", "D17-000-0011?", 1743.85, "SANDY TOWNSHIP"),
    ("002186406", "Clearfield County", "GOODROW JOYCE", "E17-000-0017", 1072.35, "SANDY TOWNSHIP"),
    ("128030908", "LYLWARD LN", "RASMUSSEN MARY E AND RICHARD N", "E17-000-0031C", 1717.56, "SANDY TOWNSHIP"),
    ("128030794", "BONIES RD", "CLINISO RICHARD", "E17-000-0017", 1717.56, "SANDY TOWNSHIP"),
    ("128030796", "Clearfield County", "CLINISO RICHARD", "E17-000-0017", 629.24, "SANDY TOWNSHIP"),
    ("128028014", "DOLPHIN HEAD RD", "TONER GREGORY PAUL & ELIZABETH", "E16-000-00027", 5219.44, "SANDY TOWNSHIP"),
    ("128028914", "SOUTH HAMPTON CT", "WERTZ PATRICIA A", "D17-000-0017-TL-01", 632.66, "SANDY TOWNSHIP"),
    ("128028915", "Clearfield County", "MELE STEFFON OR & BRITNEY", "D17-000-00011", 527.07, "SANDY TOWNSHIP"),
    ("128074745", "3 MURTLAND AVE", "ROY JAMES H", "E04-435-0130", 1375.37, "SANDY TOWNSHIP"),
    ("128074746", "VERNARD CT", "LOVELAND LIND", "C02-015-0008", 1285.44, "SANDY TOWNSHIP"),
    ("128074749", "131 HARMON HOLLOW RD", "SWARTZ IRMA L", "C03-000-0001B02", 706.29, "SANDY TOWNSHIP"),
    ("128075312", "Clearfield County", "MOUNTAIN WEST ENTRUST IRA FBO", "C02-003-0001B-21", 607.38, "SANDY TOWNSHIP"),
    ("128076554", "Clearfield County", "STAPLOWSKY GERALD J", "C02-017-0006B", 652.34, "SANDY TOWNSHIP"),
    ("128076555", "Clearfield County", "JACOBUCCI JAMIE L", "C02-000-0001?", 501.50, "SANDY TOWNSHIP"),
    ("128079147", "MIRAMAR RD", "DESPERATQ RYAN", "D17-000-0028", 398.61, "SANDY TOWNSHIP"),
    ("128079218", "Clearfield County", "WRIGHT REBECCA LYLE", "E04-000-0043A", 886.76, "SANDY TOWNSHIP"),
    ("128079228", "Clearfield County", "GENSIBEK BARRY L & DARCY C", "C02-000-0007?", 514.04, "SANDY TOWNSHIP"),
    ("128079226", "Clearfield County", "CARRASCO GUILLERMO MARINO &", "L01-000-0016", 375.70, "SANDY TOWNSHIP"),

    # Page 14 - SANDY TOWNSHIP continued
    ("128077479", "BV RD", "DEPENALLO RYAN", "C02-014-0025-02-21", 467.06, "SANDY TOWNSHIP"),
    ("128077604", "LEPORT CT", "DANIEL MAROJE A", "K09-256-0037", 467.06, "SANDY TOWNSHIP"),
    ("128077892", "Clearfield County", "CLORICH HUGH", "C10-190-0430B", 684.41, "SANDY TOWNSHIP"),
    ("128077804", "Clearfield County", "DELP STEVEN A AND MELISSA ANN", "C09-000-0012B", 723.18, "SANDY TOWNSHIP"),
    ("128078944", "Clearfield County", "WEBER MATTHEW A", "C07-014-0010B", 520.06, "SANDY TOWNSHIP"),
    ("128078946", "Clearfield County", "KALLGREN ARIEL T", "C07-041-0002", 461.90, "SANDY TOWNSHIP"),
    ("128078956", "Clearfield County", "WINTERBOTTOM/HERBERT M", "C08-000-0015", 461.79, "SANDY TOWNSHIP"),
    ("128073720", "Clearfield County", "KESORI ROBERT", "C09-000-0006/T MN", 679.42, "SANDY TOWNSHIP"),
    ("128073720", "Clearfield County", "STUMP JAMES W & LINDA L", "C08-000-0040-02-21", 725.45, "SANDY TOWNSHIP"),
    ("128093204", "GALLOWAY RD", "PIAZZA GILBERT SHAWN & MARCIE", "C08-000-0004B", 215.41, "SANDY TOWNSHIP"),
    ("128092054", "Clearfield County", "FOLMAR GERALDINE", "C08-000-0017B", 672.31, "SANDY TOWNSHIP"),
    ("128093271", "Clearfield County", "LAZOR THEODOSIS PREVOCABLE", "C06-000-0004", 636.92, "SANDY TOWNSHIP"),
    ("128093272", "168 CIRCLE RD", "HEMMPHILL HEATH", "000-000-0000 TL-32", 1725.38, "SANDY TOWNSHIP"),
    ("128067422", "27 TIMETOAD RD", "PIERCE ROBERT L", "002-000-0026 TL-02", 806.15, "SANDY TOWNSHIP"),
    ("128067433", "154 CIRCLE RD", "COUTURIAUX BREANNA & AARON", "D02-000-0026 TL-5", 4717.54, "SANDY TOWNSHIP"),

    # UNION TOWNSHIP
    ("130014619", "Clearfield County", "BROWN PERL RICHARD & JUDITH A", "F16-000-0027", 467.38, "UNION TOWNSHIP"),
    ("130014620", "DUBOIS ROCKTON RD", "CROWE HARRY T", "F08-000-000?", 1537.76, "UNION TOWNSHIP"),

    # WOODWARD TOWNSHIP
    ("131040132", "SAMSONITE ST", "WICK THOMAS R", "G06-000-0060", 533.94, "WOODWARD TOWNSHIP"),
    ("131040134", "Clearfield County", "WLUTOMICZ FRANK ET AL", "M14-000-0014", 1704.58, "WOODWARD TOWNSHIP"),
    ("131000041", "Clearfield County", "BROWN FREDERICK H", "M14-000-0015", 1810.50, "WOODWARD TOWNSHIP"),

    # Page 15 - SANDY TOWNSHIP continued
    ("128068577", "Clearfield County", "GOVER KATHLEEN E", "C02-000-0058-02-21", 700.70, "SANDY TOWNSHIP"),
    ("000089054", "Clearfield County", "WILSON ROBERT", "C02-014-0029", 375.41, "SANDY TOWNSHIP"),
    ("128065738", "BAY RD", "DEPENALLO RYAN", "C02-014-0024-01-21", 405.90, "SANDY TOWNSHIP"),
    ("128065760", "Clearfield County", "BLACK ALFONZD & LORETTA J", "C02-000-0040-02-21", 507.31, "SANDY TOWNSHIP"),
    ("128065760", "Clearfield County", "CRAWFORD GIEL & ROSIE ANN", "C08-000-0012?", 460.68, "SANDY TOWNSHIP"),
    ("128069140", "Clearfield County", "CONE CLIFFORD G & ALONA M", "C07-017-0015?", 450.19, "SANDY TOWNSHIP"),
    ("128066206", "184 CIRCLE RD", "WALTERS MAGON", "D02-000-0026 TL-21", 1801.92, "SANDY TOWNSHIP"),
    ("128065766", "Clearfield County", "GOMART JOSEPH WAYNE", "C02-021-0038 TL-05", 1714.10, "SANDY TOWNSHIP"),
    ("128066210", "Clearfield County", "COLE A NEWTON JR AND JOHN B COLT", "C02-000-0019 MN", 575.57, "SANDY TOWNSHIP"),
    ("128066213", "101 PHILLIPS CREEK RD", "FARIETER JOSHUA & JENNIFER", "D02-000 TL 5", 3295.35, "SANDY TOWNSHIP"),
    ("128066215", "SHOPE RD", "GREEN FALLS COR CORPORATION", "E04-000-0029", 2127.19, "SANDY TOWNSHIP"),
    ("128067422", "27 TIMETOAD RD", "PIERCE ROBERT L", "002-000-0026 TL-02", 806.15, "SANDY TOWNSHIP"),
    ("128067433", "154 CIRCLE RD", "COUTURIAUX BREANNA & AARON", "D02-000-0026 TL-5", 4717.54, "SANDY TOWNSHIP"),
]

def parse_money(value):
    """Parse money value to float"""
    if isinstance(value, (int, float)):
        return float(value)
    try:
        return float(str(value).replace('$', '').replace(',', ''))
    except:
        return None

def main():
    print("Clearfield County Property Parser")
    print("=" * 60)

    # Get county ID
    print("\nGetting county ID for Clearfield, PA...")
    result = supabase.rpc('get_or_create_county', {
        'p_county_name': 'Clearfield',
        'p_state_code': 'PA'
    }).execute()
    county_id = result.data
    print(f"   County ID: {county_id}")

    # Get document ID for 2025 Tax Sale List
    print("\nGetting document ID...")
    docs = supabase.table('documents').select('id').eq('county_id', county_id).eq('title', '2025 Tax Sale List (Sale Year 2026)').execute()
    if docs.data:
        document_id = docs.data[0]['id']
        print(f"   Document ID: {document_id}")
    else:
        print("   Document not found!")
        return

    # Create parsing job
    print("\nCreating parsing job...")
    job_result = supabase.rpc('create_parsing_job', {
        'p_document_id': document_id
    }).execute()
    job_id = job_result.data
    print(f"   Job ID: {job_id}")

    # Insert properties
    print(f"\nInserting {len(CLEARFIELD_PROPERTIES)} properties...")
    stored = 0
    failed = 0

    for i, prop in enumerate(CLEARFIELD_PROPERTIES):
        try:
            control_num, address, owner, map_number, upset_price, township = prop

            # Handle case where upset_price might be string
            total_due = parse_money(upset_price)

            supabase.rpc('upsert_property', {
                'p_county_id': county_id,
                'p_document_id': document_id,
                'p_parcel_id': map_number,
                'p_property_address': address,
                'p_owner_name': owner,
                'p_tax_amount': None,
                'p_total_due': total_due,
                'p_tax_year': 2026,
                'p_sale_type': 'upset',
                'p_sale_date': '2026-09-18',
                'p_raw_text': f"Control: {control_num} | Township: {township}",
                'p_confidence': 0.90
            }).execute()

            stored += 1
            if (i + 1) % 25 == 0:
                print(f"   Progress: {i + 1}/{len(CLEARFIELD_PROPERTIES)}")

        except Exception as e:
            failed += 1
            print(f"   Error storing property {control_num}: {e}")

    print(f"\n   Stored: {stored}")
    print(f"   Failed: {failed}")

    # Complete job
    avg_confidence = 0.90
    supabase.rpc('complete_parsing_job', {
        'p_job_id': job_id,
        'p_properties_extracted': stored,
        'p_properties_failed': failed,
        'p_parser_used': 'clearfield_vision_parser',
        'p_confidence_avg': avg_confidence
    }).execute()

    print("\n" + "=" * 60)
    print("PARSING COMPLETE")
    print(f"   Total Properties: {stored}")
    print(f"   Failed: {failed}")
    print("=" * 60)

if __name__ == "__main__":
    main()
